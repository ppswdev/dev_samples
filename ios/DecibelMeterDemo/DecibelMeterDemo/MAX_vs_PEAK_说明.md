# MAX vs PEAK 详细说明

## 🎯 **核心区别**

### **MAX（最大值）**

- **定义**：测量期间记录的最高声级
- **时间权重**：✅ **有**时间权重（Fast/Slow/Impulse）
- **响应特性**：经过时间滤波器处理，响应较慢
- **计算方式**：从历史数据中取最大值
- **用途**：反映一段时间内的最高噪声水平
- **标准符号**：dB(A)F, dB(A)S, dB(A)I

### **PEAK（峰值）**

- **定义**：瞬时峰值声级，无时间权重
- **时间权重**：❌ **无**时间权重，瞬时响应
- **响应特性**：直接捕获瞬时最大值，响应极快
- **计算方式**：实时追踪瞬时峰值
- **用途**：测量冲击噪声、爆炸声、瞬时冲击
- **标准符号**：dB(A) Peak

## 📊 **数值关系**

```
PEAK ≥ MAX
```

**原因**：

- PEAK捕获瞬时峰值，不受时间权重影响
- MAX经过时间权重滤波，峰值会被平滑
- 在稳态噪声中，两者可能接近
- 在冲击噪声中，PEAK明显大于MAX

## 🔬 **技术实现**

### **代码中的实现**

#### **MAX计算**

```swift
// 从历史数据中计算最大值
let maxDecibel = decibelValues.max() ?? 0.0

// 实时更新MAX
if newDecibel > maxDecibel {
    maxDecibel = newDecibel
}
```

#### **PEAK计算**

```swift
// 实时追踪瞬时峰值
if newDecibel > peakDecibel {
    peakDecibel = newDecibel
}

// 统计中使用实时PEAK值
let peakDecibel = self.peakDecibel  // 不是历史数据计算
```

## 📈 **实际应用场景**

### **稳态噪声**

```
环境：办公室环境
MAX：65.2 dB(A)F
PEAK：65.8 dB(A)
差异：0.6 dB（接近）
```

### **冲击噪声**

```
环境：建筑工地
MAX：89.3 dB(A)F  （经过时间权重）
PEAK：105.7 dB(A) （瞬时峰值）
差异：16.4 dB（显著差异）
```

### **交通噪声**

```
环境：繁忙街道
MAX：78.5 dB(A)F
PEAK：82.1 dB(A)
差异：3.6 dB（中等差异）
```

## 🎛️ **时间权重的影响**

### **Fast权重（125ms）**

- MAX值相对接近PEAK
- 适合一般噪声测量

### **Slow权重（1000ms）**

- MAX值明显小于PEAK
- 适合稳态噪声测量

### **Impulse权重（35ms↑/1500ms↓）**

- 上升时接近PEAK
- 下降时明显小于PEAK
- 专门用于冲击噪声

## 📋 **测量标准**

### **IEC 61672-1标准**

- **MAX**：必须应用时间权重
- **PEAK**：无时间权重，瞬时响应
- **符号区分**：MAX使用时间权重后缀，PEAK使用"Peak"后缀

### **应用建议**

- **环境监测**：主要关注MAX值
- **职业健康**：同时关注MAX和PEAK
- **冲击噪声**：重点关注PEAK值
- **设备测试**：需要完整的MAX/PEAK对比

## 🔧 **在分贝计中的显示**

### **界面布局**

```
┌─────────────────────────┐
│    当前分贝值显示        │
├─────────────────────────┤
│  ┌─────┬─────┬─────┐    │
│  │当前 │ Leq │     │    │
│  └─────┴─────┴─────┘    │
│  ┌───┬───┬───┬───┬───┐  │
│  │MIN│MAX│PEAK│   │   │  │
│  └───┴───┴───┴───┴───┘  │
└─────────────────────────┘
```

### **颜色编码**

- **MAX**：红色（警告级别）
- **PEAK**：紫色（危险级别）
- **MIN**：蓝色（安全级别）

## ⚠️ **重要提醒**

1. **PEAK总是≥MAX**：这是正常的物理现象
2. **用途不同**：MAX用于常规评估，PEAK用于冲击评估
3. **标准要求**：专业测量需要同时记录MAX和PEAK
4. **安全考虑**：PEAK值对听力保护更重要

---

**总结**：MAX和PEAK虽然都表示"最大值"，但它们在时间权重、响应特性、计算方式和应用场景上都有本质区别。正确理解和使用这两个指标对于准确评估噪声环境至关重要。
